# IT運用のユースケース

IT運用のユースケースを想定して、watsonx Orchestrateでの実践的なエージェント作成について学びます。
本ハンズオンではServiceNowとBrevo（メールツール）を使用してエージェントを作成します。これらの環境やConnections（接続設定）は既に設定済みのものを使用します。

## シナリオ① - プリビルドエージェント
watsonx Orchestrateでは人事や調達、ITといった業務領域に特化した事前構築済みエージェントを提供しています。ServiceNowと連携するエージェントも用意されているので、まずはそちらを試してみます。
エージェント・ビルダー→エージェントの作成→テンプレートから作成をクリックします。
![alt text](<it_images/スクリーンショット 2025-10-02 10.05.34.png>)

検索窓に"servicenow"と入力します。ServiceNowを使うプリビルドエージェントだけでも様々な種類がありますが、今回は"Incident manager"を選択します。
![alt text](<it_images/スクリーンショット 2025-10-02 10.06.19.png>)

テンプレートとして使用をクリックしてエージェントを作成します。
![alt text](<it_images/スクリーンショット 2025-10-02 10.08.31.png>)

エージェントが作成されます。共用の環境を使用している場合は、エージェントの名前の右側の編集ボタンをクリックし、あなたの名前を付けるなど、区別がつくようにしてください。
![alt text](<it_images/スクリーンショット 2025-10-02 10.11.26.png>)

エージェントの動作の先頭に「日本語で回答してください。」と追記してください。
![alt text](<it_images/スクリーンショット 2025-11-13 17.23.18.png>)

まずはインシデントを起票してみてください。
以下の例ではモデルは**llama-3-2-90b-vision-instruct**、エージェントスタイルは**デフォルト**にしています。
![alt text](<it_images/スクリーンショット 2025-11-13 16.35.18.png>)
![alt text](<it_images/スクリーンショット 2025-11-13 16.35.30.png>)

インシデントのリストを確認してみましょう。「インシデントのリストを5件取得したい」と入力してみてください。（Short Descriptionの日本語がおかしいインシデントがある場合があります。）
![alt text](<it_images/スクリーンショット 2025-11-13 16.30.00.png>)

ツールの詳細を確認して、どのような入力と出力を定義しているか確認してみましょう。
"Create an incident in ServiceNow"のツールで詳細の編集をクリックします。
![alt text](<it_images/スクリーンショット 2025-10-21 17.35.06.png>)

入力を7項目、出力を5項目定義していることがわかります。これらはすべて必須の項目ではなく、このツールの場合は"impact_value"、"urgency_value"、"short_description"の3つの入力項目を必須としています。
![alt text](it_images/image-1.png)  

## シナリオ② - ITサポートエージェント
下記の業務シナリオを実装します。

**自然言語での問い合わせ受付→過去の障害ログ・ナレッジベースから類似事例を検索、解決方法を提示→ServiceNowへインシデント起票**

本シナリオはプリビルドエージェントを使用せず、1からエージェントを作成していただきます。

![alt text](<it_images/スクリーンショット 2025-10-08 13.14.21.png>)

エージェントでの会話フロー例です。以下のイメージの通りにならなくても問題ございません。
![alt text](<it_images/スクリーンショット 2025-09-24 22.53.48.png>)
![alt text](<it_images/スクリーンショット 2025-09-24 22.52.54.png>)

ナレッジソースは[Macのサポートページ](https://support.apple.com/ja-jp/102437)を使用しました。Webページをpdf化してwatsonx Orchestrateにアップロードしています。ここは好きなドキュメントに差し替えたり、新たに別のドキュメントを追加して試してみてください。  
![alt text](it_images/image-2.png)  
??? question "エージェント作成のヒント（ナレッジソース）"
    LLM がナレッジソースではなく独自の回答を含めてしまう場合は、Knowledge setting（知識設定）の「応答」値の変更を試します。

    ![alt text](it_images/image.png)

ツールの実行はフローを使って実装しています。  

![alt text](it_images/image-3.png)  

ウェルカム・メッセージやクイック・スタート・プロンプトも定義してみましょう。

![alt text](<it_images/スクリーンショット 2025-10-14 13.33.42.png>)

!!! note
    現状ではフローを使うとインシデントの短い説明が文字化けすることがあります。実運用ではモデルを変えると回避できることがあります。

??? question "エージェント作成のヒント（フロー作成）"
    フローの概要は以下のように定義しています。  
    ![alt text](it_images/image-4.png)  
    ![alt text](it_images/image-5.png)  

    ServiceNowインシデント起票のツールのデータマッピングは修正せず、オート・マップのままにしています。

    ![alt text](it_images/image-6.png)  

    Brevoでのメール送信ツールはcontentをServiceNowのshort_description、subjectを「インシデントが起票されました」と定義しています。

    ![alt text](it_images/image-7.png)  

??? question "エージェント作成のヒント（フロー呼出時の動作）"
    Guidelineにフローを呼び出す際のステップをGuidelineに記述しています。これを記述しなくても動作しますが、インシデント起票に必要な情報をエージェントに与える際の順番を明示的に指定しています。
    ```
    [Sample]
    名前（オプション）
    インシデント起票

    条件
    インシデント起票とメール送信のリクエスト

    アクション
    Step1)インシデントの短い説明を確認してください
    Step2)インシデントの重要度（1-高、2-中、3-低）を確認してください。
    Step3)インシデントの影響度（1-高、2-中、3-低）を確認してください。
    Step4)確認メールを送付するメールアドレスを確認してください。
    ```
    ![alt text](it_images/image-8.png)  

## オプション: 様々なプリビルドツールの活用
2025年9月現在、ServiceNowに関連するプリビルドツールだけで46種類のツールが用意されています。

これらのツールを組み合わせて、ご自身が使ってみたい実用的なエージェントを作成してみてください。
![alt text](<it_images/スクリーンショット 2025-09-17 17.20.45.png>)

## お疲れ様でした！
このハンズオンでは、IT運用のユースケースを想定して、ServiceNowとメールシステムを連携したエージェントを作成しました。
